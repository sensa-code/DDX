# 小動物鑑別診斷輔助系統 v2.0 — 完整 UX 審查報告（第二次）

> **審查日期**: 2026-02-02
> **審查者角色**: 嚴格產品專案經理工程師
> **測試方法**: MCP 瀏覽器自動化 + 程式碼審查
> **測試環境**: Chrome / 1920×867 viewport / localhost:9876
> **測試範圍**: 全部功能流程、視覺設計、互動設計、無障礙、響應式

---

## 一、總體評價

系統經過第一輪修復後已有顯著改善。搜尋同義詞、年齡篩選、排序模式、深色主題等核心功能均正常運作，零 console 錯誤。但以嚴格的產品標準來看，仍有多項值得改進之處，涵蓋佈局架構、互動回饋、資訊層級、無障礙合規等面向。

**量化摘要**:
- P0 嚴重問題：2 項
- P1 重要問題：8 項
- P2 改善建議：10 項
- P3 體驗優化：6 項

---

## 二、P0 嚴重問題（必須修復）

### P0-01：側欄未獨立捲動，主內容區被強制拉長

**現象**: 側欄 `scrollHeight (3589px) === clientHeight (3589px)`，`overflow-y: auto` 但因為側欄高度沒有被限制，導致整個頁面隨側欄高度延伸。使用者在查看某一症狀的鑑別診斷時，若主內容只有 5-6 張卡片，底部仍有大片空白（因為側欄有 63 個症狀撐高了頁面）。

**影響**:
- 在 1920×867 的一般螢幕上，使用者需要大量滾動才能在側欄中找到底部的症狀
- 主內容看完後無法停止滾動，體驗割裂
- 搜尋欄和 Tab 導航會隨滾動消失，無法快速切換

**業界做法**:
- **UpToDate / DynaMed**: 側欄固定高度，獨立滾動（`position: sticky; top: header-height; height: calc(100vh - header-height); overflow-y: auto`）
- **MDN Web Docs**: 左側導航固定，主內容獨立滾動
- **Notion**: 左側目錄 sticky，主內容獨立區域

**建議修復**:
```css
.sidebar {
  position: sticky;
  top: 60px; /* header 高度 */
  height: calc(100vh - 60px);
  overflow-y: auto;
}
.main-content {
  min-height: calc(100vh - 60px);
  overflow-y: auto;
}
```

---

### P0-02：側欄收合箭頭未反映狀態

**現象**: 點擊側欄分類標題可以收合/展開症狀列表（`max-height: 0px` 生效），但箭頭圖示 `▾` 在收合後**不會**變成 `▸`。使用者無法從視覺上辨識哪些分類是收合的。

**影響**: 嚴重的狀態回饋缺失，使用者無法信任互動結果。

**業界做法**:
- 所有手風琴（accordion）元件都會旋轉箭頭或切換 icon
- Material UI 使用 `expand_more` ↔ `expand_less` icon 切換
- 部分設計使用 CSS `transform: rotate(-90deg)` 做動畫

**建議**: 在 JS toggleSection 中切換 `.arrow` 的 textContent 或使用 CSS transform。

---

## 三、P1 重要問題

### P1-01：搜尋欄和功能 Tab 不固定（non-sticky）

**現象**: 搜尋欄位和「單一症狀查詢 / 多症狀交叉比對 / 實驗室數據查詢」的 Tab 導航隨頁面滾動消失。使用者在瀏覽長列表後，想切換 Tab 或搜尋新症狀時必須手動滾回頂部。

**業界做法**:
- **Google Search Console**: 搜尋欄 sticky
- **Figma**: 左側工具列 + 頂部工具列均固定
- **Notion**: 搜尋 Ctrl+K 彈窗覆蓋，不佔據佈局

**建議**: 將搜尋欄和 Tab bar 設為 `position: sticky; top: 60px; z-index: 50;`，或使用 Ctrl+K 彈窗式搜尋。

---

### P1-02：篩選狀態跨症狀持續保留

**現象**: 在「嘔吐」頁面選擇「犬」物種篩選後，切換到「癲癇發作」頁面時，「犬」篩選仍然啟用。使用者可能未注意到篩選仍活躍，誤以為看到的是完整的鑑別診斷列表。

**業界做法**:
- **Amazon / 電商**: 切換分類時清除篩選條件，或在顯眼位置顯示「目前篩選」提示
- **PubMed**: 搜尋後保留篩選但有明確的 active filter indicator

**建議**:
- 方案 A：切換症狀時重置篩選至預設值
- 方案 B：在篩選活躍時顯示醒目的 banner（例如「⚠ 目前篩選：犬，>7歲」）在頁面頂部，並提供一鍵重置按鈕

---

### P1-03：常見伴隨症狀連結 `href="#"` 缺少實際路徑

**現象**: 症狀詳情頁中的「常見伴隨症狀」連結（如 腹瀉→嘔吐、體重減輕 等）的 `href` 屬性為 `#` 而非 `#symptom=vomiting`。雖然 JS click handler 有做導航，但：
- 無障礙讀屏器無法預告目的地
- 右鍵「在新分頁開啟」無效
- 瀏覽器狀態列不顯示目標位置

**業界做法**: 所有 SPA 框架都建議在 `<a>` 標籤上設定正確的 `href` 以支持漸進增強（Progressive Enhancement）。

**建議**: 將 `<a href="#">` 改為 `<a href="#symptom=${relatedId}">`。

---

### P1-04：歡迎頁面缺少「最近查詢」區塊的空狀態提示

**現象**: 首次訪問時（清除 sessionStorage 後），歡迎頁面只顯示統計數據和急診常見症狀快捷鍵，沒有「最近查詢」區塊，也沒有教學引導。使用者不清楚系統的完整功能（如多症狀比對、實驗室查詢）。

**業界做法**:
- **Notion**: 首次使用有 onboarding checklist
- **Linear**: 空狀態有明確的下一步指引
- **Duolingo**: 引導式 walkthrough

**建議**: 增加簡短的功能介紹卡片或步驟指引，例如「三步快速開始：1. 搜尋或選擇症狀 → 2. 篩選物種/年齡 → 3. 展開卡片查看建議檢查」。

---

### P1-05：排序模式切換後分類標題消失，缺乏過渡說明

**現象**: 從「分類」排序切換到「急度」或「頻率」排序時，分類標題（如 ● 消化、● 腫瘤）直接消失，卡片變為扁平列表。使用者可能困惑為何佈局突然改變。

**業界做法**:
- **Jira**: 切換看板/列表視圖時有動畫過渡
- **Trello**: 拖放排序有視覺反饋
- 通常會在排序模式旁標示當前模式的說明文字

**建議**:
- 在排序切換後顯示簡短的上下文提示，例如「⚡ 按緊急度排序中（無分類）」
- 或在非分類模式下仍顯示來源分類作為副標題

---

### P1-06：多症狀交叉比對結果缺少排序能力

**現象**: 當選擇 3 個症狀（嘔吐、腹瀉、體重減輕）時，結果顯示 5 項均為 2/3 (67%)，但排序似乎是固定的。使用者無法按匹配度、疾病名稱或緊急度排序結果。

**業界做法**:
- **Google Scholar**: 可按相關度/日期排序
- **Symptom Checker 類應用**（如 Isabel Healthcare）: 結果按可能性排序，並支持切換

**建議**:
- 結果預設按匹配數降序，相同匹配數按緊急度排序
- 提供排序切換（匹配度/急度/字母序）

---

### P1-07：Ctrl+K 搜尋快捷鍵可能被瀏覽器攔截

**現象**: 測試中 Ctrl+K 未能將焦點移到搜尋欄（焦點停留在 themeToggle 按鈕）。Chrome 的 Ctrl+K 預設行為是跳到網址列搜尋，可能攔截了頁面的事件監聽。

**業界做法**:
- **GitHub**: 使用 `/` 鍵作為搜尋快捷鍵（不衝突）
- **VS Code Web**: 使用 `Ctrl+Shift+F`
- **Notion**: `Ctrl+P` 作為命令面板

**建議**: 改用 `/` 鍵作為搜尋快捷鍵，或使用 `Ctrl+/`（較少衝突）。

---

### P1-08：深色模式下頻率/物種標籤對比度不足

**現象**: 在深色模式下，卡片右側的頻率標籤（常見、少見）和物種圖示（犬、貓）使用彩色文字渲染在深色背景上，對比度可能不符合 WCAG AA 標準（4.5:1 最低要求）。

**業界做法**:
- **GitHub Dark**: 使用高對比度的 badge 背景
- **Discord**: 深色模式下所有文字元件保持高對比

**建議**: 為深色模式下的標籤增加半透明背景或調整顏色至更亮的變體。

---

## 四、P2 改善建議

### P2-01：側欄缺少搜尋/篩選功能

63 個症狀分佈在 14 個分類中，側欄很長。雖然頂部有全局搜尋欄，但側欄本身沒有快速篩選。使用者若想在側欄中找到「外耳炎」需要大量滾動。

**建議**: 在側欄頂部增加一個小型篩選輸入框，或讓全局搜尋同時在側欄中 highlight 匹配項。

---

### P2-02：卡片展開/收合動畫生硬

卡片展開使用 `max-height` 過渡，由於 `max-height` 值可能與實際內容高度不匹配，展開時可能出現延遲感或跳動。

**建議**: 使用 CSS `grid` 的 `grid-template-rows: 0fr → 1fr` 過渡，或使用 JS 動態計算 scrollHeight 設定 max-height。

---

### P2-03：匯出功能只有 JSON 格式

「匯出」按鈕導出原始 JSON 數據，對於獸醫臨床使用者來說不直觀。

**業界做法**:
- **UpToDate**: 提供 PDF 列印和分享連結
- **MDN**: 可複製程式碼片段

**建議**: 增加匯出為 CSV（適合 Excel 開啟）或 PDF 格式，或至少提供「複製當前症狀鑑別列表到剪貼簿」的功能。

---

### P2-04：免責聲明位置佔據底部固定空間

免責聲明 banner 始終顯示在頁面底部，佔據約 50px 的螢幕空間。即使使用者已閱讀過，每次頁面滾動時仍可見。

**建議**:
- 改為首次訪問時的 modal 或 toast 提示
- 或在使用者點擊「我瞭解」後完全隱藏（不只是 sessionStorage，可考慮 localStorage 持久化）

---

### P2-05：症狀卡片缺少視覺優先級指引

在「分類」排序模式下，所有卡片視覺權重相同。使用者無法快速識別哪些是最重要的鑑別診斷。

**業界做法**:
- **Isabel Healthcare**: 紅/黃旗標標示危險診斷
- **UpToDate**: 關鍵信息用加粗/高亮標示

**建議**:
- 緊急 (Urgent) 卡片使用紅色左邊框 + 背景微紅
- 半緊急卡片使用橙色左邊框
- 在卡片左側或頂部增加色條來區分優先級

---

### P2-06：Tab 導航缺少鍵盤導航支持

Tab 按鈕有 `role="tab"` 和 `aria-selected`，但無法用左右箭頭鍵在 Tab 之間切換（WAI-ARIA Tab 模式要求 Arrow Key 導航）。

**建議**: 實作 Arrow Left/Right 在 tab buttons 間移動焦點的邏輯。

---

### P2-07：搜尋輸入框同時有原生清除按鈕和自訂清除按鈕

`input[type="search"]` 在 Chrome 中會自動顯示原生 `×` 清除按鈕，加上自訂的 `#searchClear` 按鈕，導致出現兩個 `×` 按鈕。視覺上可能造成混淆。

**建議**: 使用 CSS 隱藏原生清除按鈕：
```css
input[type="search"]::-webkit-search-cancel-button { -webkit-appearance: none; }
```

---

### P2-08：多症狀交叉比對的症狀按鈕排列缺乏邏輯順序

63 個症狀按鈕在多症狀面板中以 flex-wrap 方式排列，但順序似乎是數據庫的原始順序，不是按分類或字母排序。使用者難以快速找到特定症狀。

**建議**: 按分類分組顯示（小標題 + 按鈕組），與側欄的分類一致。

---

### P2-09：頁面 `<title>` 被 JS 意外修改

測試中觀察到 `document.title` 被 debug 程式碼修改為 JSON 字串（如 `{"arrowText":"▾"...}`）。雖然這可能是測試副作用，但若有任何程式碼會修改 title，應確保只設定為使用者友好的文字。

**建議**: 確認正式版本中 `document.title` 始終為「小動物鑑別診斷輔助系統 v2.0」或根據當前症狀動態更新（如「癲癇發作 — 小動物鑑別診斷輔助系統」）。

---

### P2-10：URL Hash 更新但無法分享/書籤完整狀態

URL hash 只記錄 `#symptom=seizures`，不記錄篩選條件（物種/年齡/排序模式）和當前 Tab。使用者分享 URL 時，接收者看到的是預設狀態。

**業界做法**:
- URL 參數記錄完整狀態（如 `#symptom=seizures&species=dog&age=senior&sort=urgency`）
- **Figma/Notion**: 深層連結記錄完整視圖狀態

**建議**: 將篩選條件和 Tab 狀態編碼到 URL hash 中。

---

## 五、P3 體驗優化建議

### P3-01：歡迎頁面統計數字可增加動畫效果
數字 63 / 437 / 13 直接顯示。使用 count-up 動畫可提升首次印象。

### P3-02：側欄分類圖示可更具區分度
目前使用 emoji（⚕💧💨🦴🧠👁♀🩺📋🏥🔬），部分在不同系統上渲染不一致。考慮使用 SVG icon 確保一致性。

### P3-03：鑑別診斷卡片可增加「展開全部」的快捷操作
雖然有「全部展開」按鈕，但位於頁面右側不太顯眼。可考慮在排序按鈕旁增加快捷操作。

### P3-04：多症狀比對增加「建議下一步」功能
在交叉比對結果出來後，系統可建議最佳鑑別檢查，幫助使用者決定下一步。

### P3-05：增加麵包屑導航或返回上一個症狀的功能
使用者在連續查看多個症狀後，可能想回到之前查看的症狀。瀏覽器返回鍵因為 hash navigation 可能行為不穩定。

### P3-06：增加鍵盤快捷鍵提示
在搜尋框 placeholder 或頁面角落顯示可用的快捷鍵（如 `/` 搜尋、`ESC` 關閉等），減少學習成本。

---

## 六、無障礙（A11y）評估

| 項目 | 狀態 | 備註 |
|------|------|------|
| ARIA roles | ✅ 良好 | 103 個元素有 role 屬性 |
| Tab 按鈕 | ✅ 良好 | `role="tab"` + `aria-selected` |
| 按鈕標籤 | ✅ 良好 | 170 個按鈕均有文字或 aria-label |
| 輸入框標籤 | ✅ 良好 | 有 aria-label 和 placeholder |
| 鍵盤導航 Tab 面板 | ⚠ 不完整 | 缺少 Arrow Key 切換 Tab |
| 搜尋下拉鍵盤導航 | ✅ 良好 | Arrow Up/Down + Enter |
| 色彩對比（淺色） | ✅ 良好 | 主要文字對比充足 |
| 色彩對比（深色） | ⚠ 部分不足 | 頻率標籤對比度可能不夠 |
| 連結可預測 | ⚠ 不完整 | 相關症狀連結 href="#" |
| Screen Reader 語境 | ⚠ 可改善 | 篩選變更後缺少 live region 通知 |

---

## 七、響應式設計評估

| 斷點 | 狀態 | 備註 |
|------|------|------|
| Desktop (>1200px) | ✅ 正常 | 側欄 + 主內容並排 |
| Tablet (768-1200px) | ⚠ 未測試 | CSS 無此區間的特定處理 |
| Mobile (<768px) | ✅ 有處理 | 側欄改為 fixed overlay + toggle 按鈕 |
| 列印 | ✅ 良好 | 隱藏非必要元素，卡片強制展開 |

**建議**: 增加 768-1200px 的中間斷點處理，考慮側欄收窄或改為可收合。

---

## 八、效能觀察

| 項目 | 數據 |
|------|------|
| 檔案大小 | ~163KB（單一 HTML 檔） |
| 外部依賴 | 0（完全自包含） |
| 初始載入 | 快速（無網路請求） |
| Console 錯誤 | 0 |
| DOM 元素數量 | ~170 buttons + 相關結構 |
| 搜尋 debounce | 200ms（合理） |

---

## 九、與同類型平台的對照

| 功能 | 本系統 | UpToDate | Isabel Healthcare | VetBloom |
|------|--------|----------|-------------------|----------|
| 症狀鑑別查詢 | ✅ | ✅ | ✅ | ✅ |
| 多症狀交叉比對 | ✅ | ❌ | ✅ | ❌ |
| 實驗室反向查詢 | ✅ | 部分 | ❌ | ❌ |
| 年齡篩選 | ✅ | ❌ | ✅ | ❌ |
| 急度標示 | ✅ | ✅ | ✅ | ❌ |
| 離線使用 | ✅ | ❌ | ❌ | ❌ |
| 深色模式 | ✅ | ❌ | ❌ | ❌ |
| 建議檢查項目 | ✅ | ✅ | 部分 | ❌ |
| 固定側欄導航 | ❌ | ✅ | ✅ | ✅ |
| 搜尋自動完成 | ✅ | ✅ | ✅ | ❌ |

本系統的**離線自包含**和**多維度查詢**（症狀+實驗室+交叉比對）是獨特優勢。主要差距在 UI 佈局結構和專業級互動細節。

---

## 十、修復優先級路線圖

### Sprint 1（核心佈局）
- [ ] P0-01：側欄 sticky + 獨立滾動
- [ ] P0-02：修復收合箭頭狀態
- [ ] P1-01：搜尋欄 + Tab 導航 sticky

### Sprint 2（互動改善）
- [ ] P1-02：篩選狀態管理（重置或提示）
- [ ] P1-03：修復相關症狀連結 href
- [ ] P1-05：排序模式切換的上下文提示
- [ ] P2-07：隱藏原生搜尋清除按鈕

### Sprint 3（體驗提升）
- [ ] P1-04：新手引導 / 功能說明
- [ ] P1-06：多症狀結果排序功能
- [ ] P1-07：修改搜尋快捷鍵（`/` 鍵）
- [ ] P1-08：深色模式對比度修復

### Sprint 4（進階優化）
- [ ] P2-01 ~ P2-10 各項改善
- [ ] P3-01 ~ P3-06 各項優化

---

*報告結束。本報告基於 MCP 瀏覽器自動化逐步測試所有功能流程，結合程式碼審查產出。*
