<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <title>èªæ³•ä¿®å¾©é©—è­‰</title>
  <style>
    body { font-family: 'Microsoft JhengHei', sans-serif; padding: 20px; }
    .success { color: green; font-weight: bold; }
    .error { color: red; font-weight: bold; }
    .info { color: blue; }
    pre { background: #f5f5f5; padding: 10px; border-radius: 4px; }
  </style>
</head>
<body>
  <h1>vet-differential-diagnosis-v2.html èªæ³•ä¿®å¾©é©—è­‰</h1>
  <div id="results"></div>

  <script>
    const results = document.getElementById('results');

    function addResult(message, className = 'info') {
      const div = document.createElement('div');
      div.className = className;
      div.innerHTML = message;
      results.appendChild(div);
    }

    // æ¸¬è©¦ï¼šè¼‰å…¥ä¸»æª”æ¡ˆçš„script
    addResult('<h2>æ¸¬è©¦1: è¼‰å…¥ä¸»æª”æ¡ˆscript</h2>');

    fetch('vet-differential-diagnosis-v2.html')
      .then(response => response.text())
      .then(html => {
        const scriptMatch = html.match(/<script>([\s\S]*?)<\/script>/);
        if (!scriptMatch) {
          addResult('âŒ æ‰¾ä¸åˆ°scriptæ¨™ç±¤', 'error');
          return;
        }

        const scriptContent = scriptMatch[1];
        addResult(`âœ… æˆåŠŸæå–script (${scriptContent.length} å­—å…ƒ)`, 'success');

        // å˜—è©¦åŸ·è¡Œ
        try {
          const testFunc = new Function(scriptContent);
          addResult('âœ… Scriptèªæ³•å®Œå…¨æ­£ç¢ºï¼', 'success');

          // å¯¦éš›åŸ·è¡Œä»¥ç²å–è®Šæ•¸
          testFunc.call(window);

          addResult('<h2>æ¸¬è©¦2: æª¢æŸ¥è®Šæ•¸å®šç¾©</h2>');

          if (typeof SYNONYMS !== 'undefined') {
            addResult(`âœ… SYNONYMS å·²å®šç¾© (${Object.keys(SYNONYMS).length} å€‹éµ)`, 'success');
          } else {
            addResult('âŒ SYNONYMS æœªå®šç¾©', 'error');
          }

          if (typeof DISEASE_INFO !== 'undefined') {
            const diseaseCount = Object.keys(DISEASE_INFO).length;
            addResult(`âœ… DISEASE_INFO å·²å®šç¾© (${diseaseCount} å€‹ç–¾ç—…)`, 'success');

            // åˆ—å‡ºå‰10å€‹ç–¾ç—…
            const diseases = Object.keys(DISEASE_INFO).slice(0, 10);
            addResult(`<pre>å‰10å€‹ç–¾ç—…:\n${diseases.join('\n')}</pre>`);
          } else {
            addResult('âŒ DISEASE_INFO æœªå®šç¾©', 'error');
          }

          addResult('<h2>æ¸¬è©¦3: é©—è­‰é—œéµä¿®å¾©é»</h2>');

          // æª¢æŸ¥ trigeminal-neuritis æ˜¯å¦å­˜åœ¨
          if (DISEASE_INFO['trigeminal-neuritis']) {
            addResult('âœ… trigeminal-neuritis ç–¾ç—…å®šç¾©å­˜åœ¨', 'success');
          }

          // æª¢æŸ¥ gastric-dilatation-volvulus æ˜¯å¦å­˜åœ¨ï¼ˆä¿®å¾©å¾Œçš„ä¸‹ä¸€å€‹ç–¾ç—…ï¼‰
          if (DISEASE_INFO['gastric-dilatation-volvulus']) {
            addResult('âœ… gastric-dilatation-volvulus ç–¾ç—…å®šç¾©å­˜åœ¨', 'success');
          }

          addResult('<h2>ğŸ‰ æ‰€æœ‰æ¸¬è©¦é€šéï¼ç¶²é å¯ä»¥æ­£å¸¸é‹ä½œã€‚</h2>', 'success');

        } catch (e) {
          addResult(`âŒ ScriptåŸ·è¡ŒéŒ¯èª¤: ${e.message}`, 'error');
          addResult(`<pre>${e.stack}</pre>`);
        }
      })
      .catch(error => {
        addResult(`âŒ è¼‰å…¥æª”æ¡ˆå¤±æ•—: ${error.message}`, 'error');
      });
  </script>
</body>
</html>
